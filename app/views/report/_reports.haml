- content_for :head do
  = stylesheet_link_tag :admin

.reports
  %h1
    = t("report.title")
  - if @reports.empty?
    %p
      = t("report.unreviewed_reports", count: 0)
  %ul.nav.nav-tabs{role: "tablist"}
    %li.nav-item.active{role: "presentation"}
      %a{href: "#reports", title: "New incomming reports",
        aria: {controls: "reports", selected: true}, data: {toggle: "tab"}}
        = t("report.reported_tab")
    %li.nav-item{role: "presentation"}
      %a{href: "#checked", title: "Already Reviewd reports",
        aria: {controls: "checked", selected: false}, data: {toggle: "tab"}}
        = t("report.reviewed_tab")
    %li.nav-item{role: "presentation"}
      %a{href: "#statistics", title: "Statistics about reporter and reporting items",
        aria: {controls: "statistics", selected: false}, data: {toggle: "tab"}}
        = t("report.statistics_tab")
  .tab-content
    .tab-pane.active#reports{role: "tabpanel"}
      - @reports.each do |report|
        - unless report.reviewed
          - if report.item
            .panel.panel-default
              - username = report.user.username
              .panel-heading
                .reporter.pull-right
                  != t("report.reported_label", person: link_to(username, user_profile_path(username)))
                .reason
                  %span.reason-label
                    = t("report.reason_label")
                  %span
                    = report.text
              .panel-body
                .content
                  = report_content(report)
                .segment-selection
                  = button_to t("report.reported_user_details"),
                    user_search_path(admins_controller_user_search: {guid: report.reported_author.guid}),
                    class: "btn pull-left btn-info btn-small col-md-3 col-xs-12", method: :post
                  = button_to t("report.review_link"), report_path(report.id, type: report.item_type),
                    class: "btn pull-left btn-info btn-small col-md-3 col-xs-12", method: :put
                  = button_to t("report.delete_link"), report_path(report.id, type: report.item_type),
                    data: {confirm: t("report.confirm_deletion")},
                    class: "btn pull-right btn-danger btn-small col-md-3 col-xs-12", method: :delete
          - else
            .panel.panel-default
              - username = report.user.username
              .panel-heading
                .reporter.pull-right
                  != t("report.reported_label", person: link_to(username, user_profile_path(username)))
                .title
                  = report_content(report)
              .panel-body
                = button_to t("report.review_link"), report_path(report.id, type: report.item_type),
                  class: "btn pull-left btn-info btn-small", method: :put
    .tab-pane#checked{role: "tabpanel"}
      %table.table
        %tr
          %th
            = t("report.created_at")
          %th
            = t("report.reported_by")
          %th
            = t("report.reason")
          %th
            = t("report.type")
          %th
            = t("report.decision")
          %th
            Action
        - @reports.each do |report|
          %tr
            %td
              = I18n.l(report.created_at, format: :short)
            %td
              = link_to(report.user.username, user_profile_path(report.user.username))
            %td
              = report.text
            %td
              = report.item_type
            %td
              = report.action
            %td
              - if report.action.nil?
                = link_to_content(report)
                = link_to(report_path(report.id, type: report.item_type),
                    data: {confirm: t("report.confirm_deletion")},
                    title: t("report.delete_link"),
                    class: "delete", method: :delete) do
                  %i.entypo-trash
    .tab-pane#statistics{role: "tabpanel"}
      %table.table
        %tr
          %th
            = t("report.count")
          %th
            != t("report.reported_by")
        - @reports_by_reporter.rows.each do |count, _user_id, handle, guid|
          %tr
            %td
              = count
            %td
              = link_to handle, "/people/#{guid}"
